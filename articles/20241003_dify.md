---
title: "Difyå°å…¥ å€‹äººãƒ¡ãƒ¢"
emoji: "ğŸ—‚"
type: "tech"
topics: ["aws", "dify"]
published: false
---

æ€¥ã« RAG ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’å°å…¥ã™ã‚‹ã“ã¨ã«ãªã£ãŸã®ã§â€¦
å®šæœŸçš„ã«æ›´æ–°ã—ã¾ã™

## Install Docker Compose

https://zenn.dev/rock_penguin/articles/28875c7b0a5e30<br>
https://github.com/docker/compose/releases/<br>

â€»ä»¥ä¸‹ã® v2.29.7 ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
https://github.com/docker/compose/releases/download/v2.29.7/docker-compose-linux-x86_64

```bash
sudo -s
cd
dnf update
dnf install -y docker
systemctl start docker
gpasswd -a $(whoami) docker
chgrp docker /var/run/docker.sock
systemctl restart docker
systemctl enable docker
curl -L "https://github.com/docker/compose/releases/download/v2.29.7/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose
ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
```

ã€Œuname -sã€ã¯ OS åã€ä¾‹ãˆã°ã€ŒLinuxã€
ã€Œuname -mã€ã¯ CPU ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ä¾‹ãˆã°ã€Œx86_64ã€<br>

```bash
docker -v
docker-compose -v
```

## Install Git

```bash
dnf install -y git
```

## Install Dify

https://docs.dify.ai/ja-jp/getting-started/install-self-hosted/docker-compose#difyno<br>
https://github.com/langgenius/dify/blob/main/docker/docker-compose.yaml<br>
https://docs.docker.jp/compose/profiles.html<br>

â€»ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¼‰ãŒã‚ã‚Šã€profiles ã§ã€qdrant ã‚’ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦èµ·å‹•å¯èƒ½
ã€€ç¾åœ¨ã¯ã€Qdrant ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹

```yaml
# Qdrant vector store.
# (if used, you need to set VECTOR_STORE to qdrant in the api & worker service.)
qdrant:
image: langgenius/qdrant:v1.7.3
profiles:
  - qdrant
restart: always
volumes:
  - ./volumes/qdrant:/qdrant/storage
environment:
  QDRANT_API_KEY: ${QDRANT_API_KEY:-difyai123456}
```

https://docs.dify.ai/ja-jp/getting-started/readme/features-and-specifications

```bash
git clone https://github.com/langgenius/dify.git
cd dify/docker
cp .env.example .env
docker-compose --profile qdrant up -d # qdrantã‚’ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦èµ·å‹•
docker-compose ps
```

ä»¥ä¸‹ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹

```bash
http://localhost/
http://ã‚°ãƒ­ãƒ¼ãƒãƒ« IP ã‚¢ãƒ‰ãƒ¬ã‚¹/
```

## ã‚¹ãƒšãƒƒã‚¯ã«ã¤ã„ã¦

EC2 ã® IAMRole ã¯ã€æœ€ä½é™ Bedrock ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ä»˜ä¸ã—ã¦ãŠãã‚ˆã†ã«
t3.medium ã§èµ·å‹•å¯èƒ½
EBS ã¯ã€æœ€å°ã§ 7.3GB ä½¿ç”¨ã—ãŸ
Knowledge Base ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’è“„ç©ã™ã‚‹å ´åˆã¯ã€50 ï½ 100GB ãã‚‰ã„ã‚ã£ã¦ã‚‚è‰¯ã„ã¨æ€ã†

## ãƒ­ã‚°ãƒ»ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°

https://zenn.dev/aidemy/articles/13ceca39b0ea6c<br>
https://langfuse.com/pricing<br>

Langfuse ãŒç„¡æ–™ã§ä½¿ç”¨å¯èƒ½
